{include file=custom_header.html}
<link href="/themes/mall/tmall/styles/default/css/user.css" type="text/css" rel="stylesheet">
<style type="text/css">
    .right{
        float: left;
        margin-left: 20px;
        width: 979px;
        border: 1px solid #ccc;
        padding-left: 10px;
    }
    .right .title{
        font-size: 16px;
        background-color: #f9fafc;
        padding: 4px 12px;
        border-bottom: 1px solid #c4d5e0;
        margin-left: -10px;
    }
    .right .weiquanlist{
        margin-top: 10px;
        margin-bottom: 10px;
        border-top: 1px solid #c4d5e0;
    }
    #weiquan{
        margin-top: 10px;
        padding-left: 10px;
    }
    .formtable td{
        vertical-align: middle;
        padding: 6px;
    }
    .formtable label{
        padding-right: 8px;
    }
    .formtable .text-input{
        border: 1px solid #7F9DB9;
        height: 15px;
        padding: 1px 2px;
        vertical-align: middle;
        width: 110px;
    }
    .formtable textarea{
        border: 1px solid #7F9DB9;
        height: 50px;
        width: 250px;
    }
    .formtable .cause{
        float: left;
        margin-top: 20px;
    }
    .formtable .submit{
        padding: 4px 6px;
        cursor: pointer;
    }
    .formtable .picsbt{

    }
    .formtable .pic{
        float: left;
    }
    .weiquantable{
        border-collapse: collapse;
        margin-top: 10px;
    }
    .weiquantable th{
        border: 1px solid #aec7e5;
        background: #aec7e5;
    }
    .weiquantable td, .weiquantable th{
        padding: 4px 6px;
    }
    #close{
        padding-bottom: 10px;
    }
    .list li{
        padding: 10px;
    }
    .list li .detail{
        padding-right: 10px;
        color: #36c;
    }
</style>
<div class="content" style="width: 1200px;margin: 0 auto;overflow: hidden;border-top: 1px solid #666;padding-top: 30px">
    {include file=bzhwj_member.menu.html}
    <div class="right">
        <h2 class="title">维权退款</h2>
        <div id="weiquan">
            <table class="formtable">
                <tbody>
                <tr>
                    <td><label>商品名称:</label><input type="text" class="text-input" name="goods_name"/></td>
                    <td><labe>美店名称:</labe><input type="text" class="text-input" name="store_name"/></td>
                    <td><label>价格:</label><input type="text" class="text-input" name="price"/></td>
                </tr>
                <tr>
                    <td colspan="3"><label class="cause">退款原因:</label><textarea name="reason"></textarea></td>
                </tr>
                <tr>
                    <td colspan="3">
                        <label>上传图片:</label><input style="margin-left: 4px;width: 600px" name="pic" class="text-input" value="">
                        <form style="margin-left: 62px;margin-top: 10px" class="upload-file-form" enctype="multipart/form-data" method="post" target="bridge_win" action="http://admin.bzhwj.com/generaldata/upload">
                            <input type="file" name="fileinfo">
                            <input type="submit" value="上传">
                            <iframe name="bridge_win" src="http://admin.bzhwj.com/generaldata/bridge" style="display: none"></iframe>
                        </form>
                    </td>
                </tr>
                <tr>
                    <td><label>真实姓名:</label><input type="text" class="text-input" name="actual_name"/></td>
                    <td colspan="2"><label>手机号码:</label><input type="text" class="text-input" name="phone"/></td>
                </tr>
                <tr>
                    <td colspan="3"><label>邮箱:</label><input type="text" class="text-input" name="email"/> </td>
                </tr>
                <tr>
                    <td colspan="3"><button class="submit save">提交</button><input type="hidden" name="picurl"/></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div id="process">
            <h2 class="title weiquanlist">正在进行中的维权</h2>
            <ul class="list">
                <!--{foreach from=$pending_list item=el}-->
                <li>
                    <div>
                        <span>{$el.goods_name}</span> <a href="#" class="detail" id="{$el.id}">>>详细信息</a></span>
                    </div>
                    <table class="weiquantable" for="{$el.id}" style="display: none">
                        <tbody>
                        <tr>
                            <th>id</th>
                            <th>商品名称</th>
                            <th>美店名称</th>
                            <th>价格</th>
                            <th>退款原因</th>
                            <th>真实姓名</th>
                            <th>手机号码</th>
                            <th>邮箱</th>
                        </tr>
                        <tr>
                            <td>{$el.id}</td>
                            <td>{$el.store_name}</td>
                            <td>{$el.goods_name}</td>
                            <td>{$el.price}</td>
                            <td>{$el.reason}</td>
                            <td>{$el.actual_name}</td>
                            <td>{$el.phone}</td>
                            <td>{$el.email}</td>
                        </tr>
                        </tbody>
                    </table>
                </li>
                <!--{/foreach}-->
            </ul>
        </div>
        <div id="close">
            <h2 class="title weiquanlist">已结束的退款维权</h2>
            <ul class="list">
                <!--{foreach from=$finished_lish item=el}-->
                <li>
                    <div>
                        <span>{$el.goods_name}</span> <a href="#" class="detail" id="{$el.id}">>>详细信息</a></span>
                    </div>
                    <table class="weiquantable" for="{$el.id}" style="display: none">
                        <tbody>
                        <tr>
                            <th>id</th>
                            <th>商品名称</th>
                            <th>美店名称</th>
                            <th>价格</th>
                            <th>退款原因</th>
                            <th>真实姓名</th>
                            <th>手机号码</th>
                            <th>邮箱</th>
                        </tr>
                        <tr>
                            <td>{$el.id}</td>
                            <td>{$el.store_name}</td>
                            <td>{$el.goods_name}</td>
                            <td>{$el.price}</td>
                            <td>{$el.reason}</td>
                            <td>{$el.actual_name}</td>
                            <td>{$el.phone}</td>
                            <td>{$el.email}</td>
                        </tr>
                        </tbody>
                    </table>
                </li>
                <!--{/foreach}-->
            </ul>
        </div>
    </div>
    <iframe  width="0" height="0" style="display: none" name="pic"></iframe>
</div>
{include file=helper_footer.html}
<div id="footer_index">
    Copyright 2014-2020 百真无假网 Inc.,All rights reserved.<br />
    Powered by 百真无假网 1.0
    <br />
</div>
<script src="/themes/resource/js/require.js"></script>
<script>

    $(".save").on("click", function(){
        var data=$("#weiquan input, #weiquan textarea").serialize();
        $.post("/index.php?app=bzhwj_weiquan&act=save_weiquan", data, function(msg){
            if(msg){
                alert("提交成功！");
                window.location.reload();
            }
        });
    });
    $(".detail").on("click", function(e){
        e.preventDefault();
        var index=$(this).attr("id");
        $(".weiquantable[for="+index+"]").toggle();
    });

    var entitiesMap = {
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        '&': '&amp;'
    };

    function htmlEscape(str) {
        return str.replace(/(<|>|"|&)/g, function (m, m1) {
            return entitiesMap[m1];
        });
    }

    var global = window;
    global.callback = function (data) {
        var attachmentInput = global.attachmentInput,preImg;
        if (attachmentInput) {
            attachmentInput.val(htmlEscape(data.imgurl));
            if ((preImg = attachmentInput.parents('.m-form-control-image:eq(0)').find('.preview-image img')).length > 0) {
                preImg.attr('src',data.imgurl);
            }
        }
    };
    global.addEventListener('message',function(e) {
        var data = e.data,attachmentInput = global.attachmentInput,preImg;
        if (attachmentInput) {
            attachmentInput.val(htmlEscape(data.imgurl));
            if ((preImg = attachmentInput.parents('.m-form-control-image:eq(0)').find('.preview-image img')).length > 0) {
                preImg.attr('src',data.imgurl);
            }
        }
    },false);
    $('body').on('mousedown', '.upload-file-form input[type="submit"]', function (e) {
        global.attachmentInput = $(this).parents('.upload-file-form:eq(0)').prev();
    });
</script>
</body>
</html>